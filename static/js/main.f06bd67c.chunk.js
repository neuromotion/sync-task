(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"<div class=".concat(n?"center_container":e?"main-prompt":"main",">").concat(t,"</div>")}},15:function(t,e,n){"use strict";n.d(e,"b",function(){return u}),n.d(e,"a",function(){return d});var o=n(5),r=n(25),a=n(26),c=n.n(a),i=!1;if(o.b.USE_ELECTRON){var s=window.require("electron");i=s.ipcRenderer}var u=function(){var t=o.b.USE_PHOTODIODE?"visible":"invisible";return'<div class="photodiode-box '.concat(t,'" id="photodiode-box">\n\t\t\t\t\t\t\t\t\t<span id="photodiode-spot" class="photodiode-spot"></span>\n  \t\t\t\t\t\t\t\t</div>')},d=function(t){if(o.b.USE_PHOTODIODE){var e=t;t<r.eventCodes.open_task&&(e=1),function t(e,n){n>0&&function(t,e){c()(".photodiode-spot").css({"background-color":"black"}),setTimeout(function(){c()(".photodiode-spot").css({"background-color":"white"}),e()},t)}(e,function(){setTimeout(function(){t(e,n-1)},e)})}(40,e),i&&i.send("trigger",t)}}},19:function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return c}),n.d(e,"a",function(){return s});var o,r=n(16),a=function(t){return new Promise(function(e){return setTimeout(e,t)})},c=((o=n(69)).keys().map(o),function(){var t=r.jsPsych.turk.turkInfo();return"".concat(t.workerId,":").concat(t.assignmentId)}),i=function(){return function(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var o=e[n].split("=");if(decodeURIComponent(o[0])===t)return decodeURIComponent(o[1])}}("PROLIFIC_PID")},s=function(t){var e=new AudioContext,n=e.createOscillator(),o=e.createGain();n.type=t.type,n.connect(o),n.frequency.setValueAtTime(t.frequency,0),console.log(e.currentTime),o.connect(e.destination),n.start(),n.stop(e.currentTime+.4)}},25:function(t,e){t.exports={eventCodes:{start:1,stop:2,open_task:"16"}}},41:function(t,e,n){"use strict";(function(t){var o=n(18),r=n.n(o),a=n(42),c=n(23),i=n(5),s=n(15),u=n(14),d=n(16),_=!1;if(i.b.USE_ELECTRON){var l=window.require("electron");_=l.ipcRenderer}e.a=function(){document.title=i.e;var e='\n  <div class="d-flex flex-column align-items-center">\n  <p>'.concat(i.d.instructions.camera,'</p>\n  <video id="camera" width="640" height="480" autoplay></video>\n  </div>\n  ');return{type:"html_button_response",stimulus:Object(u.a)(e,!0)+Object(s.b)(),choices:[i.d.prompt.continue.button],response_ends_trial:!0,on_load:function(){var e=d.jsPsych.data.get().values()[0].participant_id,n=document.getElementById("camera"),o=function(o,r){console.log(o),"cameraCapture"===r&&(n.srcObject=o);var a=[];window[r]=new MediaRecorder(o,{mimeType:"video/webm"}),window[r].addEventListener("dataavailable",function(t){t.data.size>0&&a.push(t.data)}),window[r].addEventListener("stop",function(){!function(e,n,o){var r=new FileReader,a="pid_".concat(o,"_").concat(n,"_").concat(Date.now(),".webm");r.onload=function(){if(2===r.readyState){var n=new t(r.result);_.send("save_video",a,n),console.log("Saving ".concat(JSON.stringify({fileName:a,size:e.size})))}},r.readAsArrayBuffer(e)}(new Blob(a),r,e)})};navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){return o(t,"cameraCapture")}),window.require("electron").desktopCapturer.getSources({types:["window"]}).then(function(){var t=Object(c.a)(r.a.mark(function t(e){var n,c,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(a.a)(e);try{for(n.s();!(c=n.n()).done;)(s=c.value).name===i.e&&navigator.mediaDevices.getUserMedia({video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s.id}}}).then(function(t){o(t,"screenCapture")}).catch(function(t){return console.log(t)})}catch(r){n.e(r)}finally{n.f()}case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},on_finish:function(){i.b.USE_CAMERA&&(window.cameraCapture.start(),window.screenCapture.start())}}}}).call(this,n(74).Buffer)},44:function(t,e,n){t.exports=n(87)},5:function(t,e,n){"use strict";n.d(e,"e",function(){return d}),n.d(e,"d",function(){return T}),n.d(e,"b",function(){return v}),n.d(e,"a",function(){return u});var o=n(16),r=n(28),a=n.n(r),c=n(25);n.d(e,"c",function(){return c.eventCodes});var i=n(40),s=n(19),u={frequency:100*(c.eventCodes.open_task-9),type:"sine"},d="TSST",_=!o.jsPsych.turk.turkInfo().outsideTurk,l=Object(s.b)()&&!_,E=!0,p="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_FIREBASE,f="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_AT_HOME;try{window.require("electron")}catch(C){E=!1}var b="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_VOLUME,A="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_VIDEO&&E,P="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_USE_EEG&&E,O="true"===Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_USE_PHOTODIODE&&E,T=n(72);if(!E){var m=n(73);a.a.merge(T,m)}var v=Object(i.init)({USE_PHOTODIODE:O,USE_EEG:P,USE_ELECTRON:E,USE_MTURK:_,USE_VOLUME:b,USE_CAMERA:A,USE_PROLIFIC:l,USE_FIREBASE:p,AT_HOME:f,TASK_NAME:d})},51:function(t,e,n){},53:function(t,e,n){},69:function(t,e,n){var o={"./blue_payout_correct_10.png":70,"./blue_payout_correct_100.png":71};function r(t){var e=a(t);return n(e)}function a(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}r.keys=function(){return Object.keys(o)},r.resolve=a,t.exports=r,r.id=69},70:function(t,e,n){t.exports=n.p+"static/media/blue_payout_correct_10.f515a81e.png"},71:function(t,e,n){t.exports=n.p+"static/media/blue_payout_correct_100.ae2416c7.png"},72:function(t){t.exports={task:{name:"Sync-task",end:"This task has ended."},prompt:{press:"Press any key to continue.",continue:"Continue",start:"Start",stop:"Stop",focus:"Make sure the photodiode is covering the spot and any external recordings have begun before continuing.",fullscreen:"Press 'cmd + ctrl + F' to toggle Fullscreen.",zoom:"Zoom in to enlarge the screen.",setting_up:"Setting up task...",heading:{open_task:"Setting up task...",start:"Starting",stop:"Stopping"}},userid:{set:"Please enter subject ID."},eventMarker:{found:"Note: event marker found.",not_found:"Note: no USB event marker found."},instructions:{adjust_volume:"Set tablet volume to 50/100.",make_sure:"Please place the CTM in your pocket. Make sure zoom recording and device recording has begun before pressing continue",start:"Press start when you are ready to begin.",stop:"Press stop when the task is over. Then stop all recordings."}}},73:function(t){t.exports={welcome:{message:"Welcome to the NEURO experiment."},userid:{set:"Setting up user ID."}}},87:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n.n(o),a=n(39),c=n.n(a),i=(n(51),n(18)),s=n.n(i),u=n(23),d=n(17),l=(n(53),n(54),n(55),n(21)),E=n(43);var p=function(t){var e=t.onLogin,n=t.envParticipantId,a=t.envStudyId,c=t.validationFunction,i=Object(o.useState)(""),s=Object(d.a)(i,2),u=s[0],_=s[1],p=Object(o.useState)(""),f=Object(d.a)(p,2),b=f[0],A=f[1],P=Object(o.useState)(!1),O=Object(d.a)(P,2),T=O[0],m=O[1];return Object(o.useEffect)(function(){_(n),A(a)},[n,a]),r.a.createElement("div",{className:"centered-h-v"},r.a.createElement("div",{className:"width-50"},T?r.a.createElement("div",{className:"alert alert-danger",role:"alert"},"The participant ID and study ID do not match"):null,r.a.createElement(l.a,{className:"centered-h-v",onSubmit:function(t){t.preventDefault(),c(u,b).then(function(t){t?e(t,b,u):m(!0)})}},r.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"participantId"},r.a.createElement(l.a.Label,null,"Participant ID"),r.a.createElement(l.a.Control,{autoFocus:!0,type:"participantId",value:u,onChange:function(t){return _(t.target.value)}})),r.a.createElement(l.a.Group,{className:"width-100",size:"lg",controlId:"studyId"},r.a.createElement(l.a.Label,null,"Study ID"),r.a.createElement(l.a.Control,{type:"studyId",value:b,onChange:function(t){return A(t.target.value)}})),r.a.createElement(E.a,{style:{width:"100%"},block:!0,size:"lg",type:"submit",disabled:!(u.length>0&&b.length>0)},"Log In"))))},f=n(16),b=n(5),A=n(15),P=n(14),O=function(t){return{type:"html_keyboard_response",stimulus:Object(P.a)("<h1>".concat(b.d.task.end,"</h1>"),!0)+Object(A.b)(),trial_duration:t}},T=n(19),m=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"html_keyboard_response",stimulus:Object(P.a)("<h1>".concat(b.d.prompt.heading[t],"</h1>"),!0)+Object(A.b)(),trial_duration:e,on_load:function(){Object(A.a)(b.c[t]),console.log(b.c[t]),!0===n&&Object(T.a)(b.a)}}},v=function(t){return{type:"html_button_response",stimulus:Object(P.a)("<div><h2>".concat(b.d.instructions[t],"</h2></div>"),!0)+Object(A.b)(),choices:[b.d.prompt[t]]}};console.log(Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}));var C=function(){return{type:"html_button_response",stimulus:Object(P.a)("<h1>".concat("TSST","</h1>"),!0)+Object(A.b)(),choices:[b.d.prompt.continue]}},S=function(){return{type:"html_keyboard_response",stimulus:Object(P.a)("<h1>".concat(b.d.prompt.setting_up,"</h1>"),!0)+Object(A.b)(),trial_duration:2e3,on_load:function(){Object(A.a)(b.c.open_task),Object(T.a)(b.a)}}},h=function(){var t=Object(u.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'<span style="color: green;">'.concat(b.d.eventMarker.found,"</span>"));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),R=function(){return{type:"html_button_response",stimulus:Object(P.a)("<div>\n    <h2 id='usb-alert'></h2></div>",!0)+Object(A.b)(),choices:[b.d.prompt.continue],on_load:function(){return h().then(function(t){return document.getElementById("usb-alert").innerHTML=t})}}},g=function(){return{type:"html_button_response",stimulus:Object(P.a)("\n    <div class='instructions'>\n    <h1>".concat(b.d.instructions.adjust_volume,"</h1>\n    </div>\n    "),!0),choices:[b.d.prompt.continue],response_ends_trial:!0}},N=n(41),I=[C()];b.b.USE_VOLUME&&I.push(g()),b.b.USE_EEG&&(I.push(R()),I.push(S())),b.b.USE_CAMERA&&I.push(Object(N.a)());var U=[{type:"html_keyboard_response",stimulus:"",timeline:I},v("start"),m("start",500),v("stop"),m("stop",500),O(5e3)];var j=function(t){var e=t.dataUpdateFunction,n=t.dataFinishFunction;return r.a.createElement("div",{className:"App"},r.a.createElement(f.Experiment,{settings:{timeline:U,on_data_update:function(t){return e(t)},on_finish:function(t){return n(t)}}}))},y=n(31);n(83);n(84).config();var w={apiKey:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_apiKey,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_authDomain,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_databaseURL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_projectId||"no-firebase",storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_storageBucket,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_messagingSenderId,appId:Object({NODE_ENV:"production",PUBLIC_URL:".",REACT_APP_EVENT_CODE:"16",REACT_APP_ICON:"tsst.icns",REACT_APP_TASK_NAME:"TSST"}).REACT_APP_appId},k=y.a.initializeApp(w).firestore();"localhost"===window.location.hostname&&k.useEmulator("localhost",8080);var D=function(t,e,n){return k.collection("participant_responses").doc(e).collection("participants").doc(t).collection("data").doc(n).set({start_time:n,app_version:window.navigator.appVersion,app_platform:window.navigator.platform,results:[]}).then(function(){return!0}).catch(function(t){return!1})},L=function(t){console.log(t);var e=t.participant_id,n=t.study_id,o=t.start_date;k.collection("participant_responses").doc(n).collection("participants").doc(e).collection("data").doc(o).update("results",y.a.firestore.FieldValue.arrayUnion(t))};y.a;var M=function(){var t=(new Date).toISOString(),e=Object(o.useState)(!1),n=Object(d.a)(e,2),a=n[0],c=n[1],i=Object(o.useState)(!1),l=Object(d.a)(i,2),E=l[0],A=l[1],P=Object(o.useState)(!1),O=Object(d.a)(P,2),m=O[0],v=O[1],C=Object(o.useState)(""),S=Object(d.a)(C,2),h=S[0],R=S[1],g=Object(o.useState)(""),N=Object(d.a)(g,2),I=N[0],U=N[1],y=Object(o.useState)("default"),w=Object(d.a)(y,2),k=w[0],M=w[1],V=Object(o.useState)(!1),B=Object(d.a)(V,2),F=B[0],x=B[1],K=new URLSearchParams(window.location.search),z=function(){var t=Object(u.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),H=function(t){},q=Object(o.useCallback)(function(e,n,o){e&&f.jsPsych.data.addProperties({participant_id:o,study_id:n,start_date:t}),c(e)},[t]);return Object(o.useEffect)(function(){if(console.log("Turk:",b.b.USE_MTURK),console.log("Firebase:",b.b.USE_FIREBASE),console.log("Prolific:",b.b.USE_PROLIFIC),console.log("Electron:",b.b.USE_ELECTRON),console.log("Video:",b.b.USE_CAMERA),console.log("Volume:",b.b.USE_VOLUME),console.log("Event Marker:",b.b.USE_EEG),console.log("Photodiode:",b.b.USE_PHOTODIODE),b.b.USE_ELECTRON){var t=window.require("electron").ipcRenderer;A(t),t.send("updateEnvironmentVariables",b.b);var e=t.sendSync("syncCredentials");e.envParticipantId&&R(e.envParticipantId),e.envStudyId&&U(e.envStudyId),M("desktop")}else if(b.b.USE_MTURK){window.lodash=_.noConflict();var n=Object(T.c)();v(new PsiTurk(n,"/complete")),M("mturk"),q(!0,"mturk",n)}else if(b.b.USE_PROLIFIC){var o=Object(T.b)();b.b.USE_FIREBASE&&o?(M("firebase"),q(!0,"prolific",o)):x(!0)}else if(b.b.USE_FIREBASE){M("firebase");var r=K.get("participantID"),a=K.get("studyID");r&&R(r),a&&U(a)}else x(!0)},[]),F?r.a.createElement("div",{className:"centered-h-v"},r.a.createElement("div",{className:"width-50 alert alert-danger"},"Please ask your task provider to enable firebase.")):r.a.createElement(r.a.Fragment,null,a?r.a.createElement(j,{dataUpdateFunction:{desktop:function(t){E.send("data",t)},firebase:function(t){L(t)},mturk:function(t){m.recordTrialData(t)},default:H}[k],dataFinishFunction:{desktop:function(){E.send("end","true")},mturk:function(){!function(){var t=Object(u.a)(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return m.saveData(),t.next=3,Object(T.d)(5e3);case 3:m.completeHIT();case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},firebase:H,default:H}[k]}):r.a.createElement(p,{validationFunction:{desktop:z,default:z,firebase:function(e,n){return D(e,n,t)}}[k],envParticipantId:h,envStudyId:I,onLogin:q}))};c.a.render(r.a.createElement(M,null),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.f06bd67c.chunk.js.map